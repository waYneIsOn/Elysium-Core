#include "CppUnitTest.h"

#include "../../../Libraries/01-Shared/Elysium.Core.IO/HuffmanTree.hpp"
#include "../../../Libraries/01-Shared/Elysium.Core.IO/MemoryStream.hpp"

using namespace Elysium::Core;
using namespace Elysium::Core::IO;
using namespace Elysium::Core::IO::Compression;
using namespace Elysium::Core::IO::Compression::HuffmanCoding;
using namespace Elysium::Core::Template;
using namespace Microsoft::VisualStudio::CppUnitTestFramework;

namespace UnitTests::Core::IO::Compression::HuffmanCoding
{
	TEST_CLASS(HuffmanTreeTests)
	{
	public:
		TEST_METHOD(BuildManuallyAndDecompress)
		{
			HuffmanTree Tree = HuffmanTree();
			HuffmanNode& RootNode = Tree.GetRootNode();

			HuffmanNode* Node0 = RootNode.SetLeft();
			HuffmanNode* Node00 = Node0->SetLeft(0x00);
			HuffmanNode* Node01 = Node0->SetRight();
			HuffmanNode* Node010 = Node01->SetLeft(0x01);
			HuffmanNode* Node011 = Node01->SetRight(0x02);

			HuffmanNode* Node1 = RootNode.SetRight();
			HuffmanNode* Node10 = Node1->SetLeft();
			HuffmanNode* Node100 = Node10->SetLeft(0x03);
			HuffmanNode* Node101 = Node10->SetRight(0x04);
			HuffmanNode* Node11 = Node1->SetRight();
			HuffmanNode* Node110 = Node11->SetLeft(0x05);
			HuffmanNode* Node111 = Node11->SetRight();
			HuffmanNode* Node1110 = Node111->SetLeft(0x06);
			HuffmanNode* Node1111 = Node111->SetRight();
			HuffmanNode* Node11110 = Node1111->SetLeft(0x07);
			HuffmanNode* Node11111 = Node1111->SetRight();
			HuffmanNode* Node111110 = Node11111->SetLeft(0x08);
			HuffmanNode* Node111111 = Node11111->SetRight();
			HuffmanNode* Node1111110 = Node111111->SetLeft(0x08);
			HuffmanNode* Node1111111 = Node111111->SetRight();
			HuffmanNode* Node11111110 = Node1111111->SetLeft(0x09);
			HuffmanNode* Node11111111 = Node1111111->SetRight();
			HuffmanNode* Node111111110 = Node1111111->SetLeft(0x0A);
			HuffmanNode* Node111111111 = Node1111111->SetRight();
			HuffmanNode* Node1111111110 = Node111111111->SetLeft(0x0B);

			// 0x8A: 1000 1010
			// 0x28: 0010 1000
			// 0x00: 0000 0000
			// 0xA2: 1010 0010
			// 0x03: 0000 0011

			/*
			Elysium::Core::uint8_t CompressedDataLength = 255;
			Elysium::Core::byte CompressedData[] = 
			{
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2,

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28, 0x00, 0xA2, 

				0x8A, 0x28, 0x00, 0xA2, 
				0x8A, 0x28,	0x03
			};
			*/

			MemoryStream TargetStream = MemoryStream();

			Assert::Fail();
		}

		TEST_METHOD(CompressAndDecompress)
		{
			/*
			const Elysium::Core::uint8_t SymbolsLength = 255;
			Elysium::Core::byte Symbols[SymbolsLength];
			Elysium::Core::uint32_t SymbolFrequencies[SymbolsLength];

			for (Elysium::Core::uint8_t i = 0; i < SymbolsLength; i++)
			{
				Symbols[i] = i;
				SymbolFrequencies[i] = 0;
			}
			*/

			String Input = u8">This is some< test הצ?`הצ.";
			for (size_t i = 0; i < Input.GetLength(); i++)
			{
				Elysium::Core::byte CurrentByte = Input[i];
				//SymbolFrequencies[CurrentByte]++;
			}









			Assert::Fail();
		}
	};
}
